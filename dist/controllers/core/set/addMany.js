"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _lodash=require("lodash"),_phillyHelpers=require("philly-helpers"),_config=require("../../../config");function handleDuplicates(err,callback){if(err.code===_config.database.errors.duplicate&&err.writeErrors){var writeErrors=err.writeErrors,duplicateErrors=(0,_lodash.map)((0,_lodash.filter)(writeErrors,["code",_config.database.errors.duplicate]),function(writeError){return writeError.getOperation()});if(!(0,_lodash.isEmpty)(duplicateErrors))return callback((0,_phillyHelpers.formatError)(err),duplicateErrors)}return callback((0,_phillyHelpers.formatError)(err))}function addMany(Schema,documents,callback){Schema.insertMany(documents,{ordered:!1}).then(function(data){return callback(null,data)}).catch(function(err){return handleDuplicates(err,callback)})}exports.default=addMany;